package config

import "path/filepath"

// GenerateDefault returns a YAML string containing the default configuration
// with comprehensive comments explaining each option.
func GenerateDefault() string {
	return `# CCD Configuration
# Generated by: ccd init
# Documentation: https://github.com/pt/ccd
#
# Place this file next to the binary, or at:
# - ~/.config/claude-deploy/config.yaml
# - ~/.claude-deploy/config.yaml

# Target directory for deployment
# Supports ~ for home directory
target: ~/.claude

# Explicit source-to-target mappings
# Only mapped paths are synced and sync-mode deletions are scoped
# to mapped target paths only. This protects unmapped target files
# (like ~/.claude/projects/) from deletion.
mappings:
  - source: CLAUDE.md
    target: CLAUDE.md
  - source: commands/
    target: commands/
  - source: skills/
    target: skills/

# Glob patterns to always ignore (never synced)
# Matched against filename only, not full path
ignore_patterns:
  - .DS_Store
  - Thumbs.db
  - .git
  - .idea
  - "*.tmp"
  - "*.log"
  - "*.swp"
  - "*~"

# Backup configuration
backup:
  # Enable automatic backups before each deploy
  enabled: true

  # Directory to store backup snapshots
  dir: ~/.claude-backups

  # Maximum number of snapshots to keep (oldest pruned first)
  max_snapshots: 5

# Default sync mode
# - "merge": Add and update files only (safe)
# - "sync": Also delete files not in source (destructive)
default_mode: merge

# Prompt for confirmation before deleting files in sync mode
confirm_deletes: true
`
}

// GetConfigOutputPath returns the path where config.yaml should be written.
// This is always next to the executable.
func GetConfigOutputPath(execPath string) string {
	return filepath.Join(filepath.Dir(execPath), "config.yaml")
}
